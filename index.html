<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Project Listing | Ashhad.com</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<style>
* {
    padding: 0px;
    margin: 0px;
    font-family: 'Montserrat', sans-serif;
    font-size: 18px;
    line-heigh: 26px;
}
OL.s1 {
    font-size: 16px;
    line-height: 24px;
}
.s1 li {
    padding: 5px 10px;
    margin-bottom: 5px;
}
</style>
</head>

<body>
<div class="container">
  <div class="row">
    <div class="col-lg-3">
      <div class="position-fixed">
        <h4 class="pt-3">Project Listing </h4>
        <small>www.ashhad.com<br>
        Tel: +92-333-2259620 <br>
            Dribbble: <a href="https://dribbble.com/ashhad1"> Link</a>  <br>
Behance: <a href="https://www.behance.net/ashhad1"> Link</a> <br>
            
 </small> </div>
    </div>
    <div class="col-lg-9">
      <ul id="list" class="s1">
      </ul>
      <script>
        async function fetchWithRateLimit(url) {
          let response;
          while (true) {
            response = await fetch(url);
            if (response.status !== 429) break;
            console.warn('Rate limited. Retrying...');
            await new Promise(resolve => setTimeout(resolve, 60000)); // Wait for 1 minute before retrying
          }
          if (!response.ok) throw new Error(`Error fetching ${url}: ${response.statusText}`);
          return response.json();
        }

        async function fetchProjectDetails(url) {
          try {
            return await fetchWithRateLimit(url);
          } catch (error) {
            console.error('Error fetching project details:', error);
          }
        }

        (async () => {
          try {
            const response = await fetchWithRateLimit('https://api.github.com/repos/ashhad-k/htmls/contents');
            if (!Array.isArray(response)) throw new Error('Expected an array of files');
            const data = response;
            console.log('Fetched data:', data);

            const promises = data.map(async (file) => {
              const details = await fetchProjectDetails(file.url);
              console.log('Fetched project details for:', file.name, details);
              return { name: file.name, path: file.path, updated_at: details.updated_at };
            });

            const projects = await Promise.all(promises);
            console.log('Projects before sorting:', projects);

            projects.sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at));
            console.log('Projects after sorting:', projects);

            let htmlString = '<ol>';
            for (let project of projects) {
              htmlString += `<li><a href="${project.path}">${project.name}</a></li>`;
            }
            htmlString += '</ol>';
            document.getElementById('list').innerHTML = htmlString;
          } catch (error) {
            console.error('Error fetching project list:', error);
          }
        })();
      </script>
    </div>
  </div>
</div>
</body>
</html>
